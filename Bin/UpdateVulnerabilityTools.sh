#!/bin/bash
BIN_FOLDER=/proj/ciexadm200/tools

#
APP=trivy
echo -n "Installed '$APP' "
$BIN_FOLDER/$APP version | grep "^Version:"

echo "Update '$APP' tool ..."
curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b $BIN_FOLDER
echo
echo -n "Updated '$APP' to "
$BIN_FOLDER/$APP version | grep "^Version:"
echo "-------------------------------------"
echo

#
APP=syft
echo -n "Installed '$APP' "
$BIN_FOLDER/$APP version | grep "^Version:"

echo "Update '$APP' tool ..."
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b $BIN_FOLDER
echo
echo -n "Updated '$APP' to "
$BIN_FOLDER/$APP version | grep "^Version:"
echo "-------------------------------------"
echo

#
APP=grype
echo -n "Installed '$APP' "
$BIN_FOLDER/$APP version | grep "^Version:"

# -- Ericsson grype update location --
cd $BIN_FOLDER || echo "Folder '$BIN_FOLDER' not exist/reachable! Exiting" ; exit 1
echo "Update '$APP' tool from Ericsson internal locations ..."
curl -s https://arm.seli.gic.ericsson.se/artifactory/proj-ews-generic-local/security/grype.tar.gz | tar zx $APP
# -- --

# -- Default grype update locations --
#echo "Update '$APP' tool from default locations ..."
#curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b $BIN_FOLDER
# -- --

echo
echo -n "Updated '$APP' to "
$BIN_FOLDER/$APP version | grep "^Version:"
echo "-------------------------------------"
echo

